import{v as E,a as S,_ as k}from"./v4.3a81ebd7.js";import{_ as P}from"./index.7c79cfa9.js";import{u as L}from"./index.d52611df.js";import{a as T,u as U}from"./auth.store.ff8ecbdb.js";import{f as B,r as u,ar as M,o as N,c as $,b as i,w as p,n as j,j as c,a as m,k as g,d as _,t as I}from"./entry.4f10bab2.js";import{e as y}from"./appwrite.a78840d9.js";const F={class:"flex items-center justify-center min-h-screen w-full"},z={class:"rounded bg-sidebar w-full p-5 m-5 md:w-[31.25rem] md:m-0"},A=m("h1",{class:"text-2xl font-bold text-center mb-5"},"Login",-1),D={class:"flex items-center justify-center flex-wrap gap-5"},W=B({__name:"login",setup(q){L({title:"Login | CatalystCRM System"});const e=u(""),a=u(""),o=u(""),l=u(""),s=u(!1),h=T(),V=U(),b=M(),d=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),f=t=>t.length>7,x=async()=>{try{await y.createEmailSession(e.value,a.value);const t=await y.get();t?(h.set(!0),V.set({email:t.email,name:t.name,status:t.status}),await b.push("/")):(s.value=!0,l.value="Invalid login credentials")}catch{s.value=!0,setTimeout(()=>{s.value=!1},5e3),e.value&&!d(e.value)?l.value="Provide valid email":a.value&&!f(a.value)?l.value="Password must be at least 8 characters length":!e.value||!a.value||!o.value?l.value="Fill all fields":l.value="There are no such users. Verify credentials or sign up!"}finally{h.set(!1)}},R=async()=>{try{e.value&&d(e.value)&&a.value&&f(a.value)&&o.value?(await y.create(E(),e.value,a.value,o.value),await x()):(s.value=!0,setTimeout(()=>{s.value=!1},3e3),!e.value&&!a.value&&!o.value?l.value="Fill all fields":a.value&&!f(a.value)?l.value="Password must be at least 8 characters length":e.value&&!d(e.value)?l.value="Provide valid email":l.value="This user already exists. Change credentials or log in!")}catch(t){console.error("Error checking user existence:",t),s.value=!0,l.value="Error checking user existence. Please, login if you already have an account or try again laterðŸ˜˜.",setTimeout(()=>{s.value=!1},5e3)}};return(t,r)=>{const C=S,v=k,w=P;return N(),$("div",F,[i(C,{class:j([{"opacity-100 pointer-events-auto":c(s)},"text-[#ffffff] bg-[#ff0000] absolute top-[15%] mx-auto max-w-xs transition-opacity opacity-0 text-center pointer-events-none"]),variant:"outline"},{default:p(()=>[_(I(c(l)),1)]),_:1},8,["class"]),m("div",z,[A,m("form",null,[i(v,{placeholder:"Email",type:"email",class:"mb-3",modelValue:c(e),"onUpdate:modelValue":r[0]||(r[0]=n=>g(e)?e.value=n:null),modelModifiers:{trim:!0}},null,8,["modelValue"]),i(v,{placeholder:"Password",type:"password",class:"mb-3",modelValue:c(a),"onUpdate:modelValue":r[1]||(r[1]=n=>g(a)?a.value=n:null),modelModifiers:{trim:!0}},null,8,["modelValue"]),i(v,{placeholder:"Name",type:"name",class:"mb-3",modelValue:c(o),"onUpdate:modelValue":r[2]||(r[2]=n=>g(o)?o.value=n:null),modelModifiers:{trim:!0}},null,8,["modelValue"]),m("div",D,[i(w,{type:"button",onClick:x},{default:p(()=>[_("Login")]),_:1}),i(w,{type:"button",onClick:R},{default:p(()=>[_("Register")]),_:1})])])])])}}});export{W as default};
